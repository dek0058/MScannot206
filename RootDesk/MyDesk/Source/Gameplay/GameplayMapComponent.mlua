@Component
script GameplayMapComponent extends Component

	@ExecSpace("ClientOnly")
	method void OnBeginPlay()
		local gameplayEntity = _EntityService:GetEntityByPath("/ui/Gameplay")
	end

	@ExecSpace("ServerOnly")
	method void Setup(string uid)
		local userLocalPlayerCom = _UserProxy:GetUserLocalPlayerComponentByServer(uid)
		if userLocalPlayerCom == nil then
			_GameServerLogic:KickByServer(uid, "로컬 플레이어를 찾을 수 없습니다.", "WorldError")
			return
		end

		local userCharacterCom = _UserProxy:GetUserCharacterComponentByServer(uid)
		if userCharacterCom == nil then
			_GameServerLogic:KickByServer(uid, "유저 캐릭터 컴포넌트를 찾을 수 없습니다.", "WorldError")
			return
		end

		userCharacterCom:Setup()
		userLocalPlayerCom:SetEnable(true)
	end

	@ExecSpace("ServerOnly")
	@EventSender("Self")
	handler HandleMapEnterEvent(MapEnterEvent e)
		_TransitionLogic:Pop(e.uid)
		self:Setup(e.uid)
	end

	@ExecSpace("ServerOnly")
	@EventSender("Self")
	handler HandleMapLeaveEvent(MapLeaveEvent e)
		-- _TransitionLogic:Push(_TransitionLogic.Default, e.uid)
		_GameplayLogic:Finalize(e.uid)
	end

end